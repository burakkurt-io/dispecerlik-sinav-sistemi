<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Uçuş Dispeçerliği | Güncel Sürüm</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #0056b3;
            --success-bg: #d4edda;
            --success-border: #28a745;
            --error-bg: #f8d7da;
            --error-border: #dc3545;
        }

        * { box-sizing: border-box; }
        body { 
            font-family: 'Roboto', sans-serif; 
            margin: 0; padding: 0; 
            background-color: #e9ecef; 
            height: 100vh;
            display: flex; flex-direction: column;
        }

        .main-wrapper {
            display: flex; flex: 1; overflow: hidden;
            max-width: 1400px; margin: 0 auto; width: 100%;
        }

        .quiz-area { flex: 3; padding: 30px; overflow-y: auto; z-index: 1; }
        .quiz-container { background: white; padding: 30px; border-radius: 12px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); position: relative; }

        .q-header { color: var(--primary-color); font-weight: 700; margin-bottom: 15px; border-bottom: 2px solid var(--primary-color); display: inline-block; }
        .question-text { font-size: 1.25em; font-weight: 500; margin-bottom: 25px; line-height: 1.5; }

        /* Tıklanmayı Garanti Altına Alan Butonlar */
        .quiz-option { 
            display: block; width: 100%; padding: 18px 20px; margin: 12px 0;
            border: 2px solid #e0e0e0; border-radius: 8px; cursor: pointer; text-align: left;
            background: white; font-size: 1.05em; transition: 0.2s; 
            position: relative; pointer-events: auto !important; /* Tıklanmayı zorla aç */
            user-select: none;
        }

        .quiz-option:hover { background: #f1f3f5; border-color: var(--primary-color); }

        /* Doğru-Yanlış Renkleri */
        .correct-selection { background-color: var(--success-bg) !important; border-color: var(--success-border) !important; color: #155724 !important; font-weight: bold; }
        .wrong-selection { background-color: var(--error-bg) !important; border-color: var(--error-border) !important; color: #721c24 !important; }

        /* Cevaplandıktan sonra butonları kilitle */
        .answered .quiz-option { pointer-events: none !important; cursor: default; }

        .nav-links { margin-top: 30px; display: flex; justify-content: space-between; }
        .nav-btn { background: var(--primary-color); color: white; border: none; padding: 12px 25px; border-radius: 5px; cursor: pointer; font-weight: bold; z-index: 10; }

        .sidebar { flex: 1; background: white; border-left: 1px solid #ddd; overflow-y: auto; padding: 20px; max-width: 250px; }
        .q-link { display: block; padding: 8px; margin-bottom: 5px; background: #f8f9fa; border-radius: 4px; text-decoration: none; color: #333; font-size: 0.85em; text-align: center; border: 1px solid transparent; }
        .q-link.active { background: var(--primary-color); color: white; }

        .footer-art { text-align: center; font-family: monospace; font-size: 7px; color: #6c757d; padding: 20px; white-space: pre; overflow-x: hidden; }

        @media (max-width: 768px) {
            .main-wrapper { flex-direction: column; }
            .sidebar { max-width: 100%; height: 200px; }
        }
    </style>
</head>
<body>

    <div class="main-wrapper">
        <main class="quiz-area">
            <div id="quiz-container" class="quiz-container">
                <div class="q-header" id="q-no">Yükleniyor...</div>
                <div class="question-text" id="q-text">Veriler yükleniyor...</div>
                <div id="options-container"></div>
                <div class="nav-links">
                    <button class="nav-btn" style="background:#6c757d" onclick="prevQuestion()">← Önceki</button>
                    <button class="nav-btn" style="background:#6c757d" onclick="randomQuestion()">Rastgele</button>
                    <button class="nav-btn" onclick="nextQuestion()">Sonraki →</button>
                </div>
            </div>
        </main>

        <aside class="sidebar">
            <div style="font-weight:bold; margin-bottom:10px; text-align:center;">SORU LİSTESİ</div>
            <div id="sidebar-list"></div>
        </aside>
    </div>

    <div class="footer-art">
   _____                _           _   _             ____                       _      _  __            _   
  / ____|              | |         | | | |           |  _ \                     | |    | |/ /           | |  
 | |     _ __ ___  __ _| |_ ___  __| | | |__  _   _  | |_) |_   _ _ __ __ _  | | __ | ' / _   _ _ __| |_ 
 | |    | '__/ _ \/ _` | __/ _ \/ _` | | '_ \| | | | |  _ <| | | | '__/ _` | | |/ / |  < | | | | '__| __|
 | |____| | |  __/ (_| | ||  __/ (_| | | |_) | |_| | | |_) | |_| | | | (_| | |   <  | . \| |_| | |  | |_ 
  \_____|_|  \___|\__,_|\__\___|\__,_| |_.__/ \__, | |____/ \__,_|_|  \__,_| |_|\_\ |_|\_\\__,_|_|   \__|
                                               __/ |                                                     
                                              |___/                                                      
    </div>

    <script>
        let questions = [];
        let currentIndex = 0;
        let isAnswered = false;

        async function loadQuestions() {
            try {
                const res = await fetch('sorular.json');
                questions = await res.json();
                renderSidebar();
                renderQuestion();
            } catch (e) { document.getElementById('q-text').innerText = "JSON Yükleme Hatası!"; }
        }

        function renderQuestion() {
            if (!questions.length) return;
            isAnswered = false;
            const container = document.getElementById('quiz-container');
            container.classList.remove('answered');

            const q = questions[currentIndex];
            document.getElementById('q-no').innerText = `${q['soru no']} [GENEL SORULAR VE CEVAPLAR EN GÜNCEL SÜRÜM]`;
            document.getElementById('q-text').innerText = q['soru'];
            
            const optContainer = document.getElementById('options-container');
            optContainer.innerHTML = '';

            ['a', 'b', 'c', 'd'].forEach(key => {
                if (q[key]) {
                    const btn = document.createElement('button');
                    btn.className = 'quiz-option';
                    btn.setAttribute('data-choice', key);
                    btn.innerText = key.toUpperCase() + ") " + q[key];
                    
                    // DOĞRUDAN EVENT LISTENER EKLE (Daha Garanti)
                    btn.addEventListener('click', function() {
                        handleSelection(this, key, q.dogru_cevap);
                    });
                    
                    optContainer.appendChild(btn);
                }
            });
            updateSidebar();
        }

        function handleSelection(clickedBtn, selectedKey, correctStr) {
            if (isAnswered) return;
            isAnswered = true;
            document.getElementById('quiz-container').classList.add('answered');

            // JSON'daki dogru_cevap'tan harfi temizle (Örn: "b) 9 sınıf" -> "b")
            // Sadece ilk karakteri alıp temizlemek en güvenlisidir.
            const correctKey = correctStr.trim().charAt(0).toLowerCase();
            
            const allBtns = document.querySelectorAll('.quiz-option');

            if (selectedKey === correctKey) {
                clickedBtn.classList.add('correct-selection');
            } else {
                clickedBtn.classList.add('wrong-selection');
                allBtns.forEach(b => {
                    if (b.getAttribute('data-choice') === correctKey) {
                        b.classList.add('correct-selection');
                    }
                });
            }
        }

        function nextQuestion() { currentIndex = (currentIndex + 1) % questions.length; renderQuestion(); }
        function prevQuestion() { currentIndex = (currentIndex - 1 + questions.length) % questions.length; renderQuestion(); }
        function randomQuestion() { currentIndex = Math.floor(Math.random() * questions.length); renderQuestion(); }
        function jump(i) { currentIndex = i; renderQuestion(); }

        function renderSidebar() {
            const list = document.getElementById('sidebar-list');
            questions.forEach((q, i) => {
                const a = document.createElement('a');
                a.className = 'q-link';
                a.id = `q-${i}`;
                a.innerText = q['soru no'];
                a.href = "#";
                a.onclick = (e) => { e.preventDefault(); jump(i); };
                list.appendChild(a);
            });
        }

        function updateSidebar() {
            document.querySelectorAll('.q-link').forEach(l => l.classList.remove('active'));
            const active = document.getElementById(`q-${currentIndex}`);
            if (active) {
                active.classList.add('active');
                active.scrollIntoView({ block: 'center', behavior: 'smooth' });
            }
        }

        loadQuestions();
    </script>
</body>
</html>
