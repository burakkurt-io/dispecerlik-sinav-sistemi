<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>U√ßu≈ü Dispe√ßerliƒüi | Sƒ±nav Portalƒ±</title>
    
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#0056b3">
    <script>
      if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('sw.js').catch(err => console.log('SW Kayƒ±t Hatasƒ±:', err));
      }
    </script>

    <script>
      window.va = window.va || function () { (window.vaq = window.vaq || []).push(arguments); };
    </script>
    <script defer src="/_vercel/insights/script.js"></script>

    <link rel="icon" type="image/png" href="img/logo.png">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        :root { --p: #0056b3; --s: #28a745; --e: #dc3545; --bg: #f0f2f5; }
        * { box-sizing: border-box; }
        
        body { font-family: 'Roboto', sans-serif; margin: 0; background: var(--bg); height: 100vh; overflow: hidden; display: flex; flex-direction: column; transition: background-color 0.3s, color 0.3s; }
        
        body.dark-mode { --bg: #121212; --p: #4facfe; background: var(--bg); color: #e0e0e0; }
        body.dark-mode .left-side, body.dark-mode .side, body.dark-mode .container, body.dark-mode .cat-btn, body.dark-mode .opt, body.dark-mode .modal-content { background: #1e1e1e; border-color: #333; color: #e0e0e0; box-shadow: 0 10px 40px rgba(0,0,0,0.5); }
        body.dark-mode .cat-btn.active { background: var(--p); color: #000; }
        body.dark-mode .opt:hover { background: #2a2a2a; border-color: var(--p); }
        body.dark-mode .header, body.dark-mode .left-header, body.dark-mode .side-header { border-bottom-color: #333; }
        body.dark-mode .q-text { color: #e0e0e0; }
        body.dark-mode .action-option { background: #2a2a2a; border-color: var(--p); color: #e0e0e0; }
        body.dark-mode .action-option:hover { background: var(--p); color: #000; }
        body.dark-mode .analiz-metin-alani { background: #2a2a2a; color: #e0e0e0; border-left-color: var(--p); }
        body.dark-mode .analiz-btn { background: #2a2a2a; color: var(--p); border-color: #333; }
        body.dark-mode .analiz-btn:hover { background: var(--p); color: #000; }
        body.dark-mode .search-box input { background: #2a2a2a; color: #fff; border-color: #444; }
        body.dark-mode .link { background: #2a2a2a; color: #e0e0e0; border-color: #333; }
        body.dark-mode .link.active { background: var(--p); color: #000; }
        body.dark-mode .action-area { border-top-color: #333; }
        body.dark-mode .sim-cb-container { background: #2a2a2a !important; border-color: #444 !important; color:#fff !important;}
        body.dark-mode .sim-cb-container:hover { border-color: var(--p) !important; background: #1a2a3a !important; }
        body.dark-mode .selected-opt { background: #004080 !important; border-color: var(--p) !important; }
        body.dark-mode .wrong-review-box { background: #1e1e1e !important; border-color: #dc3545 !important; }
        body.dark-mode .wrong-review-exp { background: #1a2a3a !important; border-color: #0056b3 !important; color: #80bfff !important; }
        body.dark-mode .review-opt { background: #2a2a2a; border-color: #444; color: #e0e0e0; }
        body.dark-mode .correct-opt { background: rgba(40, 167, 69, 0.15) !important; border-color: #28a745 !important; color: #28a745 !important; }
        body.dark-mode .wrong-opt { background: rgba(220, 53, 69, 0.15) !important; border-color: #dc3545 !important; color: #dc3545 !important; text-decoration: line-through; }
        body.dark-mode .zorluk-kutu { background: #e85900; color: black; border-color: #cc4d00; }

        .wrapper { display: flex; flex: 1; overflow: hidden; max-width: 1700px; margin: 0 auto; width: 100%; }
        
        .left-side { background: white; border-right: 1px solid #eee; display: flex; flex-direction: column; width: 280px; flex-shrink: 0; z-index: 5; transition: 0.3s; }
        .left-header { padding: 25px; border-bottom: 1px solid #eee; transition: 0.3s; }
        .left-title { text-align:center; font-weight:bold; color:var(--p); font-size:16px; text-transform: uppercase;}
        #cat-list { flex: 1; overflow-y: auto; padding: 15px; }
        
        .cat-btn { display: block; width: 100%; padding: 14px 12px; margin-bottom: 8px; background: white; border: 2px solid #e9ecef; border-radius: 8px; color: #495057; font-weight: bold; font-size: 0.85em; text-align: left; cursor: pointer; transition: 0.2s; }
        .cat-btn:hover { border-color: var(--p); color: var(--p); background: #f8fbff; transform: translateX(3px); }
        .cat-btn.active { background: var(--p); color: white; border-color: var(--p); box-shadow: 0 4px 10px rgba(0,0,0,0.1); }

        .main { flex: 1; padding: 20px; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        
        .container { background: white; width: 100%; max-width: 900px; flex: 1; min-height: 500px; max-height: 85vh; padding: 30px; border-radius: 15px; box-shadow: 0 10px 40px rgba(0,0,0,0.08); display: flex; flex-direction: column; position: relative; transition: 0.3s; }

        .header { color: var(--p); font-weight: 700; border-bottom: 2px solid var(--p); margin-bottom: 15px; font-size: 0.85em; flex-shrink: 0; padding-bottom: 5px; line-height: 1.4; display: flex; align-items: center; justify-content: space-between; transition: 0.3s; }
        .kategori-text { color: red; }

        .content-scroll-area { flex: 1; overflow-y: auto; padding-right: 10px; margin-bottom: 10px; scrollbar-width: thin; scrollbar-color: rgba(0, 86, 179, 0.4) transparent; }
        .content-scroll-area::-webkit-scrollbar { width: 8px; }
        .content-scroll-area::-webkit-scrollbar-track { background: transparent; }
        .content-scroll-area::-webkit-scrollbar-thumb { background-color: rgba(0, 86, 179, 0.25); border-radius: 10px; transition: 0.3s ease; }
        .content-scroll-area::-webkit-scrollbar-thumb:hover { background-color: rgba(0, 86, 179, 0.7); }

        .q-text { font-size: 1.15em; font-weight: 500; margin-bottom: 15px; line-height: 1.5; color: #2c3e50; white-space: pre-wrap; transition: 0.3s; }
        
        #opts { display: flex; flex-direction: column; justify-content: flex-start; }
        .opt { display: block; width: 100%; padding: 14px; margin: 6px 0; border: 2px solid #f1f3f5; border-radius: 10px; cursor: pointer; background: #fff; font-size: 1.05em; text-align: left; transition: all 0.2s ease; }
        .opt:hover { border-color: var(--p); background: #f8faff; transform: translateX(5px); }
        .ans-mode .opt { pointer-events: none; }
        .correct { background: var(--s) !important; color: white !important; border-color: var(--s) !important; font-weight: bold; }
        .wrong { background: var(--e) !important; color: white !important; border-color: var(--e) !important; }
        .selected-opt { background: #cce5ff !important; border-color: var(--p) !important; font-weight: bold; }

        .action-area { flex-shrink: 0; width: 100%; margin-top: 10px; border-top: 1px solid #eee; padding-top: 15px; transition: 0.3s; display: flex; flex-direction: column; }
        
        .zorluk-kutu { display: none; background: #FFF3CD; color: white; padding: 8px 12px; border-radius: 6px; font-size: 0.85em; margin-bottom: 10px; border: 1px solid #e85900; font-weight: bold; width: fit-content; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .cikmis-kutu { display: none; background: #003366; color: white; padding: 12px; border-radius: 8px; font-size: 0.85em; margin-bottom: 10px; border: 1px solid #002244; line-height: 1.4; box-shadow: 0 4px 6px rgba(0,0,0,0.1); font-weight: bold;}
        .cikmis-oran { color: #ffc107; display: block; margin-top: 5px; font-size: 0.9em; text-transform: uppercase; font-weight: bold; }

        .btn-acikla { background: #28a745; color: white; width: 100%; padding: 12px; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 0.9em; text-transform: uppercase; margin-bottom: 10px; transition: 0.2s; }
        .btn-acikla:hover { background: #218838; }
        .aciklama-kutusu { display: none; background: #28a745; color: white; font-weight: bold; padding: 15px; border-radius: 8px; font-size: 0.95em; margin-bottom: 15px; white-space: pre-wrap; line-height: 1.4; }

        .nav { display: flex; justify-content: space-between; gap: 10px; }
        .btn { flex: 1; padding: 12px; border: none; border-radius: 8px; cursor: pointer; background: var(--p); color: white; font-weight: bold; font-size: 0.85em; text-transform: uppercase; transition: 0.2s;}
        .btn:hover { opacity: 0.9; }
        .btn-gray { background: #6c757d; }
        .btn-reset { background: #ffc107; color: #000; }

        .side { flex-shrink: 0; background: white; border-left: 1px solid #eee; display: flex; flex-direction: column; width: 320px; transition: 0.3s; }
        .side-header { padding: 25px; border-bottom: 1px solid #eee; transition: 0.3s; }
        .side-title { text-align:center; font-weight:bold; color:var(--p); margin-bottom:15px; font-size:16px; }
        .search-box { display: flex; gap: 8px; }
        .search-box input { flex: 1; padding: 10px; border: 1px solid #ccc; border-radius: 6px; transition: 0.3s; }
        .search-box button { background: var(--p); color: white; border: none; padding: 0 15px; border-radius: 6px; cursor: pointer; font-weight: bold; }

        #list { flex: 1; overflow-y: auto; padding: 15px 25px; position: relative; }
        .link { display: block; padding: 12px; margin: 6px 0; background: #f8f9fa; text-decoration: none; color: #495057; font-size: 14px; text-align: center; border-radius: 8px; transition: 0.2s; border: 1px solid transparent; cursor: pointer;}
        .link.active { background: var(--p); color: white; font-weight: bold; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }

        .sim-cb-container { display: flex; align-items: center; gap: 8px; background: #f8f9fa; padding: 12px; border-radius: 8px; cursor: pointer; border: 2px solid #eee; transition: 0.2s; color: #333; }
        .sim-cb-container:hover { border-color: var(--p); background: #eef5ff; }

        .diff-btn { flex: 1; padding: 12px 5px; border-radius: 8px; border: 2px solid; font-weight: bold; font-size: 12px; cursor: pointer; background: white; transition: 0.2s; text-align: center; display: flex; align-items: center; justify-content: center; }
        .diff-all { border-color: #333; color: #333; }
        .diff-easy { border-color: #28a745; color: #28a745; }
        .diff-med { border-color: #ffc107; color: #d39e00; } 
        .diff-hard { border-color: #dc3545; color: #dc3545; }
        
        .diff-btn.active.diff-all { background: #333; color: white; }
        .diff-btn.active.diff-easy { background: #28a745; color: white; }
        .diff-btn.active.diff-med { background: #ffc107; color: black; border-color: #ffc107; }
        .diff-btn.active.diff-hard { background: #dc3545; color: white; }
        
        body.dark-mode .diff-btn { background: #1e1e1e; }
        body.dark-mode .diff-all { border-color: #aaa; color: #aaa; }
        body.dark-mode .diff-btn.active.diff-all { background: #aaa; color: #000; }

        .wrong-review-box { border: 1px solid #f5c6cb; border-left: 5px solid #dc3545; padding: 15px; border-radius: 8px; margin-bottom: 15px; text-align:left; background: #fff; box-shadow: 0 4px 6px rgba(0,0,0,0.05); }
        .wrong-review-exp { background: #eef5ff; color: #0056b3; padding: 10px; border-radius: 5px; font-size: 13px; border: 1px solid #b8daff; line-height: 1.5; margin-top: 10px; }
        .review-opt { padding: 8px 12px; border: 1px solid #eee; border-radius: 6px; font-size: 13px; background: #fdfdfd; color: #333; margin-bottom: 4px; display: flex; align-items: flex-start; gap: 8px; }
        .correct-opt { background: #d4edda !important; border-color: #28a745 !important; color: #155724 !important; font-weight: bold; }
        .wrong-opt { background: #f8d7da !important; border-color: #dc3545 !important; color: #721c24 !important; text-decoration: line-through; }

        .footer-area { display: flex; flex-direction: column; align-items: center; gap: 8px; padding: 10px; width: 100%; background: transparent; z-index: 10; }
        .footer-buttons { display: flex; gap: 8px; align-items: center; flex-wrap: wrap; justify-content: center; }
        .footer-note { font-size: 11px; color: var(--p); font-weight: bold; letter-spacing: 1px; margin-right: 10px; }
        .btn-footer { border: none; padding: 8px 15px; border-radius: 20px; cursor: pointer; font-size: 11px; font-weight: bold; transition: 0.2s; color:white; }
        .f-analiz { background: #17a2b8; }
        .f-donate { background: #ffc107; color: #000; }
        .f-iletisim { background: #0088cc; }
        .f-guncelle { background: #6c757d; font-size: 9px; padding: 5px 10px; }
        .btn-footer:hover { transform: translateY(-2px); opacity: 0.9;}
        .disclaimer { font-size: 9px; color: #888; text-align: center; max-width: 950px; margin-top: 2px; line-height: 1.2; opacity: 0.8; }

        .modal { display: none; position: fixed; z-index: 10000; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); backdrop-filter: blur(8px); }
        .modal-content { background: white; margin: 5% auto; padding: 40px; border-radius: 20px; width: 90%; max-width: 550px; position: relative; max-height: 90vh; overflow-y: auto; transition: 0.3s; }
        .close-btn { position: absolute; right: 25px; top: 20px; font-size: 35px; cursor: pointer; z-index: 100; color: #888; }
        .analiz-modal-content { max-width: 850px; }
        
        .btn-back { background: #6c757d; color: white; border: none; padding: 10px 20px; border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 13px; display: inline-block; transition: 0.2s; position: relative; z-index: 9999; }
        .btn-back:hover { background: #5a6268; }
        
        .analiz-btn { display: block; width: 100%; padding: 16px; margin-bottom: 10px; background: #f8fbff; border: 2px solid #e9ecef; border-radius: 10px; color: var(--p); font-weight: bold; font-size: 14px; text-align: left; cursor: pointer; transition: 0.3s; }
        .analiz-btn:hover { background: var(--p); color: white; border-color: var(--p); transform: translateY(-2px); }
        .analiz-metin-alani { background: #fdfdfd; padding: 20px; border-radius: 8px; border-left: 4px solid var(--p); font-size: 14px; line-height: 1.7; color: #333; white-space: pre-wrap; }
        .action-option { display: block; padding: 18px; margin: 12px 0; border: 2px solid var(--p); border-radius: 12px; text-decoration: none; color: #333; font-weight: bold; text-align: center; background: #f8fbff; cursor: pointer; }
        .action-option:hover { background: var(--p); color: white; transform: translateY(-3px); }
        .donate-option { border-color: #ffc107; background: #fffdf5; color: #333;}
        .donate-option:hover { background: #ffc107; color: #000; }
        .d-price { display: block; font-size: 0.85em; font-weight: normal; margin-top: 5px; opacity: 0.8; }

        @media (max-width: 1000px) { 
            body { height: auto; display: block; overflow: visible; }
            .wrapper { display: flex; flex-direction: column; overflow: visible; }
            .left-side { width: 100%; max-height: 250px; border-right: none; border-bottom: 2px solid #eee; }
            .main { display: block; padding: 10px; }
            .container { height: auto; min-height: 50vh; max-height: none; overflow: visible; padding: 20px; margin-bottom: 20px; }
            .q-text { max-height: none; overflow: visible; }
            .side { width: 100%; height: auto; border-left: none; border-top: 2px solid #eee; }
            #list { max-height: 350px; overflow-y: auto; }
            .diff-btn { font-size: 11px; padding: 10px 2px; }
        }
    </style>
</head>
<body>

    <div class="wrapper">
        <aside class="left-side">
            <div class="left-header">
                <div class="left-title">DERS SE√áƒ∞Mƒ∞</div>
            </div>
            <div id="cat-list"></div>
        </aside>

        <main class="main">
            <div id="q-container" class="container">
                <div class="header">
                    <div style="display:flex; align-items:center; gap:10px;">
                        <img src="img/logo.png" alt="Logo" style="height: 24px; width: auto;">
                        <span id="no">G√úNCEL SORU BANKASI Y√úKLENƒ∞YOR...</span>
                    </div>
                    <div style="display:flex; align-items:center; gap:15px;">
                        <span id="timer-display" style="display:none; font-weight:bold; color:#dc3545; font-size:15px; border: 1px solid #dc3545; padding: 2px 8px; border-radius: 5px;">00:00</span>
                        <button id="installAppBtn" onclick="installPWA()" style="background:none; border:none; cursor:pointer; font-size:18px; display:none;" title="Ana Ekrana Ekle (Uygulama Yap)">üì≤</button>
                        <button onclick="toggleDarkMode()" id="darkModeBtn" style="background:none; border:none; cursor:pointer; font-size:16px;" title="Gece/G√ºnd√ºz Modu">üåô</button>
                    </div>
                </div>
                
                <div class="content-scroll-area" id="content-scroll">
                    <div id="txt" class="q-text">L√ºtfen bekleyin...</div>
                    <img id="q-img" src="" alt="Soru G√∂rseli" style="display:none; max-width: 100%; max-height: 200px; margin-bottom: 15px; border-radius: 8px; object-fit: contain;">
                    <div id="opts"></div>
                </div>
    
                <div class="action-area" id="action-area">
                    <div id="zorluk-alani" class="zorluk-kutu"></div>
                    <div id="cikmis-alani" class="cikmis-kutu"></div>
                    <button class="btn-acikla" id="btnAcikla" onclick="aciklamaGosterGizle()">A√áIKLA</button>
                    <div id="aciklama-alani" class="aciklama-kutusu"></div>

                    <div class="nav" id="nav-buttons">
                        <button class="btn btn-gray" onclick="move(-1)">√ñnceki</button>
                        <button class="btn btn-reset" onclick="resetQ()">Reset</button>
                        <button class="btn btn-gray" onclick="rand()">Random</button>
                        <button class="btn" onclick="move(1)">Sonraki</button>
                    </div>
                </div>
            </div>
        </main>

        <aside class="side">
            <div class="side-header">
                <div class="side-title">SORU NAVƒ∞GASYONU</div>
                <div class="search-box">
                    <input type="text" id="q-search" placeholder="Soru No (√ñrn: S.12)" onkeypress="handleSearch(event)">
                    <button onclick="goToQuestion()">Gƒ∞T</button>
                </div>
            </div>
            <div id="list"></div>
        </aside>
    </div>

    <div class="footer-area">
        <div class="footer-buttons">
            <div class="footer-note">CREATED BY BURAK KURT</div>
            <button class="btn-footer f-analiz" onclick="openModal('analizModal')">ANALƒ∞Z NOTLARI</button>
            <button class="btn-footer f-donate" onclick="openModal('donateModal')">DONATE ME</button>
            <button class="btn-footer f-iletisim" onclick="openModal('iletisimModal')">ƒ∞LETƒ∞≈ûƒ∞M</button>
            <button class="btn-footer f-guncelle" onclick="openGuncelleModal()">G√úNCELLEME NOTLARI</button>
        </div>
        <div class="disclaimer">
            √ñNEMLƒ∞ NOT: Soru √ß√∂z√ºmlemeleri ve yapƒ±sal veri entegrasyonu, doƒürudan geli≈ütirici seviyesindeki Google AI Studio √ºzerinden gemini-3.1-pro-preview (Bilgi kesim tarihi: Ocak 2025) LLM API'si kullanƒ±larak i≈ülenmi≈ütir. Havacƒ±lƒ±kta emniyet ve doƒürulama esastƒ±r; operasyonel veya akademik ≈ü√ºphe durumunda bilgiyi daima yetkili eƒüitmenlerinizle teyit ediniz.
        </div>
    </div>

    <div id="customConfirmModal" class="modal" style="z-index: 100000;">
        <div class="modal-content" style="max-width: 400px; text-align: center; padding: 30px;">
            <h3 style="color: var(--p); margin-top: 0; text-transform: uppercase;">‚ö†Ô∏è Sƒ±nav Uyarƒ±sƒ±</h3>
            <p id="confirm-msg" style="color: #555; font-size: 14px; margin-bottom: 25px; line-height: 1.5; font-weight: bold;"></p>
            <div style="display: flex; gap: 10px;">
                <button class="btn btn-gray" onclick="closeConfirm(false)" style="flex: 1;">ƒ∞ptal Et</button>
                <button class="btn" onclick="closeConfirm(true)" style="flex: 1; background: #dc3545;">Evet, √áƒ±k</button>
            </div>
        </div>
    </div>

    <div id="guncelleModal" class="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="closeModal('guncelleModal')">&times;</span>
            <h2 style="text-align:center; color:#6c757d; text-transform: uppercase; margin-bottom: 5px; font-size: 16px;">G√ºncelleme Notlarƒ±</h2>
            <div id="guncelle-metin" class="analiz-metin-alani" style="max-height: 50vh; overflow-y: auto; margin-top:15px;"></div>
        </div>
    </div>

    <div id="iletisimModal" class="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="closeModal('iletisimModal')">&times;</span>
            <h2 style="text-align:center; color:#0056b3; margin-bottom:25px; text-transform: uppercase;">ƒ∞leti≈üim Kanallarƒ±</h2>
            <a href="https://t.me/burakkurt_dispatch" target="_blank" class="action-option">Telegram ile Ula≈üƒ±n</a>
            <a href="mailto:6cy8oal8y@mozmail.com" class="action-option">E-Posta G√∂nderin</a>
        </div>
    </div>

    <div id="donateModal" class="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="closeModal('donateModal')">&times;</span>
            <h2 style="text-align:center; color:#ffc107; margin-bottom:25px; text-transform: uppercase;">U√ßu≈ü Destek Paketleri</h2>
            <a href="https://www.shopier.com/dispecerliksinavsistemi/44651529" target="_blank" class="action-option donate-option">Economy Class <span class="d-price">100 TL - Kƒ±sa Menzil Desteƒüi</span></a>
            <a href="https://www.shopier.com/dispecerliksinavsistemi/44651866" target="_blank" class="action-option donate-option">Business Class <span class="d-price">500 TL - Konforlu Geli≈üim Desteƒüi</span></a>
            <a href="https://www.shopier.com/dispecerliksinavsistemi/44651917" target="_blank" class="action-option donate-option">Golden Ticket VIP <span class="d-price">1000 TL - First Class Operasyon Desteƒüi</span></a>
            <a href="https://www.shopier.com/dispecerliksinavsistemi/44651987" target="_blank" class="action-option donate-option">"Sayende Dispe√ß Oldum" <span class="d-price">2000 TL - Efsanevi Kariyer Desteƒüi</span></a>
        </div>
    </div>

    <div id="analizModal" class="modal">
        <div class="modal-content analiz-modal-content">
            <span class="close-btn" onclick="closeModal('analizModal')">&times;</span>
            <h2 style="text-align:center; color:#17a2b8; text-transform: uppercase; margin-bottom: 5px;">Analiz Notlarƒ±</h2>
            
            <div id="analiz-menu" style="max-height: 60vh; overflow-y: auto; padding-right: 10px; margin-top: 15px;">
                <button class="analiz-btn" onclick="openAnaliz('genel', 'Genel Soru Analizi')">Genel Soru Analizi</button>
                <button class="analiz-btn" onclick="openAnaliz('notlar', 'Sizin Notlarƒ±nƒ±z')">Sizin Notlarƒ±nƒ±z</button>
                <button class="analiz-btn" onclick="openAnaliz('mb', '1 - M&B - AƒûIRLIK VE DENGE')">1 - M&B - AƒûIRLIK VE DENGE</button>
                <button class="analiz-btn" onclick="openAnaliz('hpl', '2 - HPL - ƒ∞NSAN PERFORMANSI VE Lƒ∞Mƒ∞TLERƒ∞')">2 - HPL - ƒ∞NSAN PERFORMANSI VE Lƒ∞Mƒ∞TLERƒ∞</button>
                <button class="analiz-btn" onclick="openAnaliz('dgr', '3 - DGR - TEHLƒ∞KELƒ∞ MADDELER')">3 - DGR - TEHLƒ∞KELƒ∞ MADDELER</button>
                <button class="analiz-btn" onclick="openAnaliz('com', '4 - COM - HABERLE≈ûME')">4 - COM - HABERLE≈ûME</button>
                <button class="analiz-btn" onclick="openAnaliz('law', '5 - LAW - HAVA HUKUKU VE HAVA TRAFƒ∞K KONTROL')">5 - LAW - HAVA HUKUKU VE HAVA TRAFƒ∞K KONTROL</button>
                <button class="analiz-btn" onclick="openAnaliz('hav', '6 - HAV - HAVA TRAFƒ∞K Y√ñNETƒ∞Mƒ∞')">6 - HAV - HAVA TRAFƒ∞K Y√ñNETƒ∞Mƒ∞</button>
                <button class="analiz-btn" onclick="openAnaliz('met', '7 - MET - METEOROLOJƒ∞')">7 - MET - METEOROLOJƒ∞</button>
                <button class="analiz-btn" onclick="openAnaliz('pef', '8 - PEF - PERFORMANS')">8 - PEF - PERFORMANS</button>
                <button class="analiz-btn" onclick="openAnaliz('sec', '9 - SEC - G√úVENLƒ∞K')">9 - SEC - G√úVENLƒ∞K</button>
                <button class="analiz-btn" onclick="openAnaliz('nav', '10 - NAV - SEYR√úSEFER')">10 - NAV - SEYR√úSEFER</button>
                <button class="analiz-btn" onclick="openAnaliz('fpl', '11 - FPL&FM - U√áU≈û PLANLAMA VE TAKƒ∞Bƒ∞')">11 - FPL&FM - U√áU≈û PLANLAMA VE TAKƒ∞Bƒ∞</button>
                <button class="analiz-btn" onclick="openAnaliz('avi', '12 - AVI - HAVACILIK √ñƒûRETƒ∞Mƒ∞')">12 - AVI - HAVACILIK √ñƒûRETƒ∞Mƒ∞</button>
            </div>
            
            <div id="analiz-icerik" style="display:none;">
                <button type="button" class="btn-back" onclick="closeAnaliz()">‚Üê Men√ºye D√∂n</button>
                <div style="max-height: 55vh; overflow-y: auto; padding-right: 10px; margin-top: 15px;">
                    <h3 id="analiz-baslik" style="color:var(--p); margin-top:0; margin-bottom: 15px; border-bottom: 2px solid #eee; padding-bottom: 10px;"></h3>
                    <div id="analiz-metin" class="analiz-metin-alani"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        function showCustomNotification(msg, type="success") {
            let container = document.getElementById('custom-notification');
            if (!container) {
                container = document.createElement('div');
                container.id = 'custom-notification';
                container.style.cssText = "position:fixed; top:-50px; left:50%; transform:translateX(-50%); z-index:99999; padding:12px 24px; border-radius:8px; color:white; font-weight:bold; font-size: 14px; box-shadow:0 4px 15px rgba(0,0,0,0.3); transition:opacity 0.3s ease, top 0.3s ease; opacity:0; pointer-events:none;";
                document.body.appendChild(container);
            }
            let bgColor = "#28a745"; 
            if (type === "error") bgColor = "#dc3545"; 
            if (type === "warning") bgColor = "#fd7e14"; 
            container.style.backgroundColor = bgColor;
            container.innerText = msg;
            container.style.top = "20px"; container.style.opacity = "1";
            setTimeout(() => { container.style.opacity = "0"; container.style.top = "-50px"; }, 3000);
        }

        let confirmAction = null;
        function showConfirm(msg, callback) {
            document.getElementById('confirm-msg').innerText = msg;
            confirmAction = callback;
            document.getElementById('customConfirmModal').style.display = 'block';
        }
        function closeConfirm(result) {
            document.getElementById('customConfirmModal').style.display = 'none';
            if(result && confirmAction) confirmAction();
        }

        let deferredPrompt;
        const installBtn = document.getElementById('installAppBtn');
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault(); deferredPrompt = e; installBtn.style.display = 'block';
        });
        async function installPWA() {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                const { outcome } = await deferredPrompt.userChoice;
                deferredPrompt = null; installBtn.style.display = 'none';
            }
        }
        window.addEventListener('appinstalled', () => {
            installBtn.style.display = 'none'; showCustomNotification("Uygulama ba≈üarƒ±yla eklendi!", "success");
        });

        if(localStorage.getItem('darkMode') === 'enabled') {
            document.body.classList.add('dark-mode');
            document.getElementById('darkModeBtn').innerText = '‚òÄÔ∏è';
        }
        function toggleDarkMode() {
            document.body.classList.toggle('dark-mode');
            const btn = document.getElementById('darkModeBtn');
            if(document.body.classList.contains('dark-mode')) {
                localStorage.setItem('darkMode', 'enabled'); btn.innerText = '‚òÄÔ∏è';
            } else {
                localStorage.setItem('darkMode', 'disabled'); btn.innerText = 'üåô';
            }
        }

        let isExamModeActive = false;
        let examUserAnswers = [];
        let timerInterval = null;
        let selectedDifficulty = 'ALL';

        const examSubjects = [
            { code: "M&B", name: "1 - M&B (Aƒüƒ±rlƒ±k ve Denge)" },
            { code: "HPL", name: "2 - HPL (ƒ∞nsan Performansƒ±)" },
            { code: "DGR", name: "3 - DGR (Tehlikeli Maddeler)" },
            { code: "COM", name: "4 - COM (Haberle≈üme)" },
            { code: "LAW", name: "5 - LAW (Hava Hukuku)" },
            { code: "HAV", name: "6 - HAV (Hava Trafik Y√∂netimi)" },
            { code: "MET", name: "7 - MET (Meteoroloji)" },
            { code: "PEF", name: "8 - PEF (Performans)" },
            { code: "SEC", name: "9 - SEC (G√ºvenlik)" },
            { code: "NAV", name: "10 - NAV (Seyr√ºsefer)" },
            { code: "FPL", name: "11 - FPL&FM (U√ßu≈ü Planlama)" },
            { code: "AVI", name: "12 - AVI (Havacƒ±lƒ±k √ñƒüretimi)" }
        ];

        function selectDiff(btn, val) {
            document.querySelectorAll('.diff-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            selectedDifficulty = val;
        }

        function renderSimulationSetup() {
            document.getElementById('no').innerText = "SINAV Sƒ∞M√úLASYONU MERKEZƒ∞";
            document.getElementById('opts').innerHTML = '';
            document.getElementById('q-img').style.display = 'none';
            document.getElementById('action-area').style.display = 'none';

            let html = `
                <div style="padding: 10px; width:100%;">
                    <div style="background: ${document.body.classList.contains('dark-mode') ? '#2a2a2a' : '#eef5ff'}; padding: 15px; border-radius: 8px; margin-bottom: 20px; font-size: 14px; line-height: 1.5; border-left: 4px solid var(--p);">
                        <strong style="color:var(--p); font-size: 16px;">üìã Kurallar ve Dinamik Zorluk:</strong><br>
                        ‚Ä¢ Se√ßtiƒüiniz dersler i√ßin <b>Genel ve GOLDEN</b> havuzlarƒ± birle≈ütirilir.<br>
                        ‚Ä¢ Belirlediƒüiniz zorluk derecesindeki sorulardan <b>rastgele 10 adet</b> √ßekilir.<br>
                        ‚Ä¢ Ders ba≈üƒ±na <b>15 Dakika</b> s√ºre verilir. Dersi ge√ßmek i√ßin en az <b>7 Doƒüru</b> gereklidir.<br>
                    </div>
                    
                    <h3 style="margin-bottom: 10px; color: var(--p); font-size: 14px;">Zorluk Derecesi:</h3>
                    <div style="display: flex; gap: 8px; margin-bottom: 25px;">
                        <button class="diff-btn diff-all active" onclick="selectDiff(this, 'ALL')">RASTGELE</button>
                        <button class="diff-btn diff-easy" onclick="selectDiff(this, 'EASY')">KOLAY (1-2)</button>
                        <button class="diff-btn diff-med" onclick="selectDiff(this, 'MEDIUM')">ORTA (3-4)</button>
                        <button class="diff-btn diff-hard" onclick="selectDiff(this, 'HARD')">ZOR (4-5)</button>
                    </div>

                    <h3 style="margin-bottom: 15px; color: var(--p); font-size: 14px;">Sim√ºlasyona Dahil Edilecek Dersler:</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(240px, 1fr)); gap: 10px; margin-bottom: 20px;" id="sim-subject-grid">
                    </div>
                    <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                        <button onclick="document.querySelectorAll('.sim-cb').forEach(cb => cb.checked = true);" class="btn btn-gray" style="flex: 1; min-width: 150px;">T√ºm√ºn√º Se√ß (12 Ders)</button>
                        <button onclick="startSimulation()" class="btn" style="flex: 2; background: #28a745; min-width: 200px;">Sƒ∞M√úLASYONU BA≈ûLAT</button>
                    </div>
                </div>
            `;
            document.getElementById('txt').innerHTML = html;
            document.getElementById('list').innerHTML = ''; 
            
            const grid = document.getElementById('sim-subject-grid');
            examSubjects.forEach((sub, i) => {
                grid.innerHTML += `
                    <label class="sim-cb-container">
                        <input type="checkbox" class="sim-cb" value="${i}" style="width: 18px; height: 18px; cursor:pointer;">
                        <span style="font-size: 13px; font-weight: bold;">${sub.name}</span>
                    </label>
                `;
            });
        }

        function startSimulation() {
            const checkboxes = document.querySelectorAll('.sim-cb:checked');
            if(checkboxes.length === 0) {
                showCustomNotification("L√ºtfen en az bir ders se√ßin!", "warning"); return;
            }

            let totalQuestions = [];
            
            checkboxes.forEach(cb => {
                const sub = examSubjects[cb.value];
                let subQs = allQs.filter(q => {
                    let catStr = (q['Kategori'] || "").toUpperCase();
                    let regex = new RegExp("\\b" + sub.code + "\\b");
                    return regex.test(catStr) || catStr.includes("GOLDEN - " + sub.code);
                });

                if(selectedDifficulty !== "ALL") {
                    subQs = subQs.filter(q => {
                        let z = parseInt(q['Zorluk Derecesi(1-5)']);
                        if(isNaN(z)) return true;
                        if(selectedDifficulty === "EASY") return z <= 2;
                        if(selectedDifficulty === "MEDIUM") return z === 3 || z === 4;
                        if(selectedDifficulty === "HARD") return z >= 4;
                    });
                }

                subQs = subQs.sort(() => 0.5 - Math.random());
                totalQuestions.push(...subQs.slice(0, 10)); 
            });

            if(totalQuestions.length === 0) {
                showCustomNotification("Se√ßtiƒüiniz zorlukta yeterli soru bulunamadƒ±!", "error"); return;
            }

            filteredQs = totalQuestions;
            examUserAnswers = new Array(filteredQs.length).fill(null);
            isExamModeActive = true;
            idx = 0;

            let totalMins = checkboxes.length * 15;
            
            document.getElementById('action-area').style.display = 'flex'; 
            document.getElementById('btnAcikla').style.display = 'none'; 
            document.getElementById('cikmis-alani').style.display = 'none';
            document.getElementById('zorluk-alani').style.display = 'none';
            document.getElementById('nav-buttons').innerHTML = `
                <button class="btn btn-gray" onclick="move(-1)">√ñnceki Soru</button>
                <button class="btn" onclick="finishExam()" style="background:#dc3545; color:white; flex:0.8;">SINAVI Bƒ∞Tƒ∞R</button>
                <button class="btn" onclick="move(1)">Sonraki Soru</button>
            `;

            renderExamNavList();
            startExamTimer(totalMins);
            showExamQuestion();
            showCustomNotification(`Sƒ±nav Ba≈üladƒ±! ${filteredQs.length} Soru. S√ºre: ${totalMins} Dk.`, "success");
        }

        function startExamTimer(minutes) {
            const timerDisplay = document.getElementById('timer-display');
            clearInterval(timerInterval);
            let timeLeft = minutes * 60; 
            timerDisplay.style.display = "block";

            timerInterval = setInterval(() => {
                timeLeft--;
                let m = Math.floor(timeLeft / 60);
                let s = timeLeft % 60;
                timerDisplay.innerText = `${m}:${s < 10 ? '0' : ''}${s}`;
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    showCustomNotification("S√úRE Bƒ∞TTƒ∞! Sƒ±nav otomatik sonlandƒ±rƒ±lƒ±yor.", "error");
                    finishExam();
                }
            }, 1000);
        }

        function renderExamNavList() {
            const l = document.getElementById('list'); l.innerHTML = ''; 
            filteredQs.forEach((q, i) => {
                const a = document.createElement('a');
                a.className = 'link'; a.id = 'l' + i; a.innerText = "Soru " + (i + 1);
                a.onclick = () => { idx = i; showExamQuestion(); };
                l.appendChild(a);
            });
        }

        function updateExamNavList() {
            document.querySelectorAll('.link').forEach(x => { x.classList.remove('active'); x.style.borderLeft = "none"; });
            filteredQs.forEach((q, i) => {
                const a = document.getElementById('l'+i);
                if(examUserAnswers[i] !== null) a.style.borderLeft = "4px solid #28a745"; 
            });
            const active = document.getElementById('l'+idx);
            if(active) { 
                active.classList.add('active'); active.style.borderLeft = "none"; 
                document.getElementById('list').scrollTo({ top: active.offsetTop - (document.getElementById('list').clientHeight / 2) + (active.clientHeight / 2), behavior: 'smooth' });
            }
        }

        function showExamQuestion() {
            const q = filteredQs[idx];
            document.getElementById('content-scroll').scrollTop = 0;
            
            let searchStr = ((q['Kategori'] || "") + " " + (q['Soru Numarasƒ±'] || "")).toUpperCase();
            let subName = "Karma";
            examSubjects.forEach(sub => { 
                let regex = new RegExp("\\b" + sub.code + "\\b");
                if(regex.test(searchStr) || searchStr.includes("GOLDEN - " + sub.code)) subName = sub.code; 
            });

            document.getElementById('no').innerHTML = `Soru ${idx + 1} / ${filteredQs.length} <span class="kategori-text">(${subName})</span>`;
            document.getElementById('txt').innerText = q['Soru Metni'];
            
            const img = document.getElementById('q-img');
            if(q['Resim Yolu'] && q['Resim Yolu'] !== "Bilinmiyor" && q['Resim Yolu'] !== "") {
                img.src = q['Resim Yolu']; img.style.display = "block";
            } else { img.style.display = "none"; }

            const zorlukKutu = document.getElementById('zorluk-alani');
            if(q['Zorluk Derecesi(1-5)']) {
                zorlukKutu.innerHTML = `‚≠ê Zorluk Seviyesi (1-5) : ${q['Zorluk Derecesi(1-5)']}`;
                zorlukKutu.style.display = "inline-block";
            } else { zorlukKutu.style.display = "none"; }

            const oDiv = document.getElementById('opts'); oDiv.innerHTML = '';
            ['a','b','c','d','e'].forEach(h => {
                const key = h.toUpperCase() + " ≈ûƒ±kkƒ±";
                if(q[key] && q[key] !== "Bilinmiyor" && q[key].trim() !== "") {
                    const b = document.createElement('button'); b.className = 'opt';
                    if(examUserAnswers[idx] === h) b.classList.add('selected-opt');
                    
                    let sikIcerigi = q[key].trim();
                    if(sikIcerigi.toLowerCase().endsWith('.png') || sikIcerigi.toLowerCase().endsWith('.jpg')) {
                        sikIcerigi = `<br><img src="${sikIcerigi}" style="max-height: 80px; max-width: 100%; margin-top: 8px; border-radius: 4px; object-fit: contain;">`;
                    }
                    b.innerHTML = "<b>" + h.toUpperCase() + ")</b> " + sikIcerigi;
                    
                    b.onclick = () => { examUserAnswers[idx] = h; showExamQuestion(); };
                    oDiv.appendChild(b);
                }
            });
            updateExamNavList();
        }

        function finishExam() {
            clearInterval(timerInterval);
            document.getElementById('timer-display').style.display = "none";
            document.getElementById('opts').innerHTML = '';
            document.getElementById('q-img').style.display = 'none';
            document.getElementById('action-area').style.display = 'none';
            document.getElementById('no').innerText = "Sƒ∞M√úLASYON SONU√áLARI";

            let results = {}; 
            let wrongTopics = {};
            let wrongQuestionsHtml = "";

            filteredQs.forEach((q, i) => {
                let searchStr = ((q['Kategori'] || "") + " " + (q['Soru Numarasƒ±'] || "")).toUpperCase();
                let subName = "Diƒüer", subCode = "MIX";
                examSubjects.forEach(sub => { 
                    let regex = new RegExp("\\b" + sub.code + "\\b");
                    if(regex.test(searchStr) || searchStr.includes("GOLDEN - " + sub.code)) { subName = sub.name; subCode = sub.code; }
                });

                if(!results[subName]) results[subName] = { total: 0, correct: 0, wrong: 0, empty: 0 };
                results[subName].total++;
                
                const ans = examUserAnswers[i];
                const correctAns = (q['Doƒüru Cevap'] || "").trim().toLowerCase();
                
                if(!ans) results[subName].empty++;
                else if(ans === correctAns) results[subName].correct++;
                else results[subName].wrong++;

                if(ans !== correctAns) {
                    let parts = (q['Kategori'] || "").split('-');
                    let topic = parts.length > 2 ? parts[parts.length-1].trim() : "Genel Kapsamlƒ± Konular";
                    if(q['Kategori'].includes('GOLDEN') && parts.length <= 2) topic = "GOLDEN Karma Soru";
                    
                    let topicKey = `[${subCode}] ${topic}`;
                    wrongTopics[topicKey] = (wrongTopics[topicKey] || 0) + 1;

                    let optionsHtml = "";
                    ['a','b','c','d','e'].forEach(h => {
                        const optText = q[h.toUpperCase() + " ≈ûƒ±kkƒ±"];
                        if(optText && optText !== "Bilinmiyor" && optText.trim() !== "") {
                            let isCorrect = (h === correctAns);
                            let isUserAns = (h === ans);
                            let optClass = "review-opt";
                            if(isCorrect) optClass += " correct-opt";
                            else if(isUserAns) optClass += " wrong-opt";

                            let displayHtml = optText.trim();
                            if(displayHtml.toLowerCase().endsWith('.png') || displayHtml.toLowerCase().endsWith('.jpg')) {
                                displayHtml = `<br><img src="${displayHtml}" style="max-height:50px; border-radius:4px; margin-top:4px;">`;
                            }
                            optionsHtml += `<div class="${optClass}"><b style="width:20px; flex-shrink:0;">${h.toUpperCase()})</b> <div>${displayHtml}</div></div>`;
                        }
                    });

                    wrongQuestionsHtml += `
                        <div class="wrong-review-box">
                            <div style="font-weight:bold; color:var(--p); margin-bottom:8px; display:flex; justify-content:space-between; font-size:14px;">
                                <span>Soru ${i+1} (${q['Soru Numarasƒ±']})</span>
                                <span style="color:#888; font-size:11px; text-transform:uppercase;">${subCode}</span>
                            </div>
                            <div style="margin-bottom:12px; font-size:14px; line-height:1.5;">${q['Soru Metni']}</div>
                            <div style="display:flex; flex-direction:column; gap:4px; margin-bottom:10px;">
                                ${optionsHtml}
                            </div>
                            <div class="wrong-review-exp">
                                <b>A√ßƒ±klama:</b> ${q['A√ßƒ±klama'] || 'Bu soru i√ßin a√ßƒ±klama bulunmuyor.'}
                            </div>
                        </div>
                    `;
                }
            });

            let isDark = document.body.classList.contains('dark-mode');
            let html = `<div style="width:100%; overflow-x:auto;"><table style="width:100%; border-collapse: collapse; margin-bottom: 20px; font-size: 13px; min-width:600px;">
                <tr style="background:var(--p); color:white; text-align:left;">
                    <th style="padding:10px;">Ders Adƒ±</th><th style="padding:10px;">Soru</th><th style="padding:10px;">Doƒüru</th><th style="padding:10px;">Yanlƒ±≈ü</th><th style="padding:10px;">Bo≈ü</th><th style="padding:10px;">Puan</th><th style="padding:10px;">Durum</th>
                </tr>`;
            
            let totalC = 0, totalW = 0, totalE = 0, totalQ = 0;
            for(let key in results) {
                let r = results[key];
                totalC += r.correct; totalW += r.wrong; totalE += r.empty; totalQ += r.total;
                let score = (r.correct / r.total) * 100;
                let status = score >= 70 ? '<span style="color:#28a745; font-weight:bold;">GE√áTƒ∞</span>' : '<span style="color:#dc3545; font-weight:bold;">KALDI</span>';
                
                html += `<tr style="border-bottom: 1px solid #ddd; color: ${isDark ? '#ccc' : '#333'};">
                    <td style="padding:10px; font-weight:bold;">${key}</td><td style="padding:10px;">${r.total}</td>
                    <td style="padding:10px; color:#28a745; font-weight:bold;">${r.correct}</td>
                    <td style="padding:10px; color:#dc3545;">${r.wrong}</td>
                    <td style="padding:10px; color:#888;">${r.empty}</td>
                    <td style="padding:10px; font-weight:bold;">${score.toFixed(0)}</td><td style="padding:10px;">${status}</td>
                </tr>`;
            }

            let overallScore = (totalC / totalQ) * 100;
            html += `</table>
                <div style="background:${isDark ? '#1e1e1e' : '#f8f9fa'}; padding:15px; border-radius:8px; text-align:center; font-size:16px; border: 2px solid ${overallScore >= 70 ? '#28a745' : '#dc3545'}; margin-bottom:20px; color: ${isDark ? '#fff' : '#333'};">
                    Genel Ortalama: <b>${overallScore.toFixed(0)}</b> / 100<br>
                    <span style="font-size:13px; color:#888;">(Toplam: ${totalC} Doƒüru, ${totalW} Yanlƒ±≈ü, ${totalE} Bo≈ü)</span>
                </div>`;

            if(Object.keys(wrongTopics).length > 0) {
                html += `<div style="background: ${isDark ? '#332b00' : '#fff3cd'}; border: 1px solid #ffeeba; border-left: 5px solid #ffc107; padding: 15px; border-radius: 8px; margin-bottom: 25px; text-align: left; color: ${isDark ? '#ffdd80' : '#856404'};">
                    <h3 style="margin-top:0; margin-bottom:10px; font-size:14px; text-transform:uppercase;">üéØ Zayƒ±f Olduƒüunuz Alt Konular (√áalƒ±≈üma Re√ßetesi)</h3>
                    <ul style="margin:0; padding-left:20px; font-size:13px; line-height:1.6;">`;
                for(let t in wrongTopics) { html += `<li><b>${t}</b> alanƒ±ndan <b>${wrongTopics[t]} soruyu</b> yanlƒ±≈ü veya bo≈ü yaptƒ±nƒ±z.</li>`; }
                html += `</ul></div>`;
            }

            if(wrongQuestionsHtml !== "") {
                html += `<h3 style="color:var(--p); margin-top:20px; text-align:center; border-bottom:2px solid #eee; padding-bottom:10px; font-size:15px;">‚ùå YANLI≈û VE BO≈û YAPILAN SORULARIN √á√ñZ√úMLERƒ∞</h3>` + wrongQuestionsHtml;
            }

            html += `<button onclick="exitExamMode()" class="action-option" style="width:100%; margin-top:20px;">Sƒ∞STEME GERƒ∞ D√ñN</button></div>`;
            document.getElementById('txt').innerHTML = html;
        }

        function exitExamMode() {
            isExamModeActive = false;
            clearInterval(timerInterval);
            document.getElementById('timer-display').style.display = "none";
            document.getElementById('action-area').style.display = 'flex';
            document.getElementById('btnAcikla').style.display = 'block';
            document.getElementById('nav-buttons').innerHTML = `
                <button class="btn btn-gray" onclick="move(-1)">√ñnceki</button>
                <button class="btn btn-reset" onclick="resetQ()">Reset</button>
                <button class="btn btn-gray" onclick="rand()">Random</button>
                <button class="btn" onclick="move(1)">Sonraki</button>
            `;
            filterByCategory('CIKMIS'); 
        }

        document.addEventListener('keydown', (e) => {
            if(document.activeElement.id === 'q-search') return;
            const key = e.key.toLowerCase();
            if(['a', 'b', 'c', 'd', 'e'].includes(key)) {
                const opts = document.getElementById('opts').children;
                const index = key.charCodeAt(0) - 97;
                if(opts[index] && !document.getElementById('q-container').classList.contains('ans-mode')) opts[index].click();
            } 
            else if (e.key === 'ArrowRight') { move(1); } 
            else if (e.key === 'ArrowLeft') { move(-1); } 
            else if (e.key === ' ' && !isExamModeActive) { e.preventDefault(); const btn = document.getElementById('btnAcikla'); if(btn.style.display !== 'none') btn.click(); }
        });

        let allQs = []; 
        let filteredQs = []; 
        let idx = 0; 

        const categories = [
            { name: "üöÄ Sƒ∞M√úLASYON MODU", keyword: "SIMULATION" },
            { name: "üèÜ GOLDEN SORULAR", keyword: "CIKMIS" },
            { name: "‚≠ê GOLDEN - DGR", keyword: "GOLDEN - DGR" },
            { name: "‚≠ê GOLDEN - LAW", keyword: "GOLDEN - HAVA" },
            { name: "‚≠ê GOLDEN - NAV", keyword: "GOLDEN - SEYR" },
            { name: "‚≠ê GOLDEN - COM", keyword: "GOLDEN - HABER" },
            { name: "üìö T√úM SORULAR", keyword: "ALL" },
            { name: "1 - AƒûIRLIK VE DENGE (M&B)", keyword: "M&B" },
            { name: "2 - ƒ∞NSAN PERFORMANSI (HPL)", keyword: "HPL" },
            { name: "3 - TEHLƒ∞KELƒ∞ MADDELER (DGR)", keyword: "DGR" },
            { name: "4 - HABERLE≈ûME (COM)", keyword: "COM" },
            { name: "5 - HAVA HUKUKU (LAW)", keyword: "LAW" },
            { name: "6 - HAVA TRAFƒ∞K Y√ñNETƒ∞Mƒ∞ (HAV)", keyword: "HAV" },
            { name: "7 - METEOROLOJƒ∞ (MET)", keyword: "MET" },
            { name: "8 - PERFORMANS (PEF)", keyword: "PEF" },
            { name: "9 - G√úVENLƒ∞K (SEC)", keyword: "SEC" },
            { name: "10 - SEYR√úSEFER (NAV)", keyword: "NAV" },
            { name: "11 - U√áU≈û PLANLAMA (FPL&FM)", keyword: "FPL" },
            { name: "12 - HAVACILIK √ñƒûRETƒ∞Mƒ∞ (AVI)", keyword: "AVI" }
        ];

        async function start() {
            try {
                document.getElementById('no').innerText = "VERƒ∞TABANLARI Y√úKLENƒ∞YOR...";
                document.getElementById('txt').innerText = "Sorular hazƒ±rlanƒ±yor, l√ºtfen bekleyin...";

                const urls = [ 'sorular.json', 'kdm_dgr_sorular.json', 'kdm_law_final.json', 'kdm_nav_final.json', 'kdm_com_final.json' ];
                const responses = await Promise.all(urls.map(url => fetch(url).catch(e => { return { json: () => [] }; })));
                const dataArrays = await Promise.all(responses.map(res => res.json()));

                allQs = [];
                dataArrays.forEach(arr => {
                    if (Array.isArray(arr)) {
                        arr.forEach(item => {
                            if(item['Kategori']) item['Kategori'] = item['Kategori'].replace(/KDM/g, 'GOLDEN');
                            if(item['Soru Numarasƒ±']) item['Soru Numarasƒ±'] = item['Soru Numarasƒ±'].replace(/KDM/g, 'GOLDEN');
                        });
                        allQs.push(...arr);
                    }
                });

                filteredQs = allQs.filter(q => q['Sƒ±nav Anƒ±sƒ±'] !== undefined); 
                renderCategories();
                renderList();
                show();
            } catch(e) { 
                document.getElementById('no').innerText = "BAƒûLANTI HATASI";
                document.getElementById('txt').innerText = "Veriler sunucudan √ßekilemedi.";
            }
        }

        function renderCategories() {
            const catContainer = document.getElementById('cat-list');
            catContainer.innerHTML = '';
            categories.forEach(cat => {
                const btn = document.createElement('button');
                btn.className = 'cat-btn' + (cat.keyword === 'CIKMIS' ? ' active' : '');
                btn.innerText = cat.name;
                btn.onclick = () => filterByCategory(cat.keyword, btn);
                catContainer.appendChild(btn);
            });
        }

        function filterByCategory(keyword, clickedBtn) {
            if(isExamModeActive && keyword !== 'SIMULATION') {
                showConfirm("Sƒ±nav devam ediyor! √áƒ±kmak istediƒüinize emin misiniz? Sƒ±nav verileriniz silinecek.", () => {
                    exitExamMode();
                    executeCategoryFilter(keyword, clickedBtn);
                });
                return;
            }
            executeCategoryFilter(keyword, clickedBtn);
        }

        function executeCategoryFilter(keyword, clickedBtn) {
            document.querySelectorAll('.cat-btn').forEach(b => b.classList.remove('active'));
            if(clickedBtn) {
                clickedBtn.classList.add('active');
            } else if (keyword === 'SIMULATION') {
                document.querySelector('.cat-btn').classList.add('active'); 
            }

            if(!isExamModeActive) { 
                document.getElementById('action-area').style.display = 'flex';
                document.getElementById('btnAcikla').style.display = 'block';
            }

            if(keyword === 'SIMULATION') { renderSimulationSetup(); return; }

            if(keyword === 'ALL') {
                filteredQs = [...allQs];
            } else if (keyword === 'CIKMIS') {
                filteredQs = allQs.filter(q => q['Sƒ±nav Anƒ±sƒ±'] !== undefined);
            } else if (keyword.startsWith('GOLDEN')) {
                filteredQs = allQs.filter(q => (q['Kategori'] || "").toUpperCase().includes(keyword));
            } else {
                filteredQs = allQs.filter(q => {
                    const cat = (q['Kategori'] || "").toUpperCase();
                    let regex = new RegExp("\\b" + keyword + "\\b");
                    return regex.test(cat) && !cat.includes('GOLDEN');
                });
            }
            idx = 0; 
            renderList();
            show();
        }

        function renderList() {
            const l = document.getElementById('list'); l.innerHTML = ''; 
            filteredQs.forEach((q, i) => {
                const a = document.createElement('a'); a.className = 'link'; a.id = 'l' + i; a.innerText = q['Soru Numarasƒ±'];
                a.onclick = () => { idx = i; show(); }; l.appendChild(a);
            });
        }

        function show() {
            if(!filteredQs.length) {
                document.getElementById('no').innerText = "Bƒ∞LGƒ∞"; document.getElementById('txt').innerText = "Bu kategoriye ait soru bulunamadƒ±.";
                document.getElementById('opts').innerHTML = ''; document.getElementById('q-img').style.display = "none";
                document.getElementById('aciklama-alani').style.display = "none"; document.getElementById('cikmis-alani').style.display = "none";
                document.getElementById('zorluk-alani').style.display = "none"; document.getElementById('btnAcikla').style.display = "none"; return;
            }

            document.getElementById('btnAcikla').style.display = "block";
            const q = filteredQs[idx];
            const cont = document.getElementById('q-container'); cont.classList.remove('ans-mode');
            document.getElementById('content-scroll').scrollTop = 0;
            
            let temizKategori = (q['Kategori'] || "").replace(/^\d+\)\s*/, '') || "Genel Havacƒ±lƒ±k";
            document.getElementById('no').innerHTML = q['Soru Numarasƒ±'] + ' <span class="kategori-text">(' + temizKategori + ')</span>';
            document.getElementById('txt').innerText = q['Soru Metni'];
            
            const img = document.getElementById('q-img');
            if(q['Resim Yolu'] && q['Resim Yolu'] !== "Bilinmiyor" && q['Resim Yolu'] !== "") { img.src = q['Resim Yolu']; img.style.display = "block"; } else { img.style.display = "none"; }

            const zorlukKutu = document.getElementById('zorluk-alani');
            if(q['Zorluk Derecesi(1-5)']) {
                zorlukKutu.innerHTML = `‚≠ê Zorluk Seviyesi (1-5) : ${q['Zorluk Derecesi(1-5)']}`;
                zorlukKutu.style.display = "inline-block";
            } else { zorlukKutu.style.display = "none"; }

            const cikmisKutu = document.getElementById('cikmis-alani');
            if(q['Sƒ±nav Anƒ±sƒ±']) { cikmisKutu.innerHTML = `<i>"${q['Sƒ±nav Anƒ±sƒ±']}"</i> <span class="cikmis-oran">E≈üle≈üme Oranƒ±: ${q['E≈üle≈üme Oranƒ±']}</span>`; cikmisKutu.style.display = "block"; } else { cikmisKutu.style.display = "none"; }

            const aKutu = document.getElementById('aciklama-alani'); aKutu.style.display = "none"; aKutu.innerText = q['A√ßƒ±klama'] || "A√ßƒ±klama bulunamadƒ±.";

            const oDiv = document.getElementById('opts'); oDiv.innerHTML = '';
            ['a','b','c','d','e'].forEach(h => {
                const key = h.toUpperCase() + " ≈ûƒ±kkƒ±";
                if(q[key] && q[key] !== "Bilinmiyor" && q[key].trim() !== "") {
                    const b = document.createElement('button'); b.className = 'opt';
                    let sikIcerigi = q[key].trim();
                    if(sikIcerigi.toLowerCase().endsWith('.png') || sikIcerigi.toLowerCase().endsWith('.jpg')) sikIcerigi = `<br><img src="${sikIcerigi}" style="max-height: 80px; max-width: 100%; margin-top: 8px; border-radius: 4px; object-fit: contain;">`;
                    b.innerHTML = "<b>" + h.toUpperCase() + ")</b> " + sikIcerigi;
                    
                    b.onclick = () => {
                        cont.classList.add('ans-mode'); const dogru = (q['Doƒüru Cevap'] || "").trim().toLowerCase();
                        if(h === dogru) b.classList.add('correct');
                        else {
                            b.classList.add('wrong');
                            Array.from(oDiv.children).forEach(btn => { if(btn.innerHTML.toLowerCase().includes("<b>" + dogru + ")</b>")) btn.classList.add('correct'); });
                        }
                    };
                    oDiv.appendChild(b);
                }
            });

            document.querySelectorAll('.link').forEach(x => x.classList.remove('active'));
            const active = document.getElementById('l'+idx);
            if(active) { active.classList.add('active'); document.getElementById('list').scrollTo({ top: active.offsetTop - (document.getElementById('list').clientHeight / 2) + (active.clientHeight / 2), behavior: 'smooth' }); }
        }

        function move(n) { if(!filteredQs.length) return; idx = (idx+n+filteredQs.length)%filteredQs.length; if(isExamModeActive) showExamQuestion(); else show(); }
        function rand() { if(!filteredQs.length) return; idx = Math.floor(Math.random()*filteredQs.length); show(); }
        function resetQ() { show(); }
        function handleSearch(e) { if (e.key === 'Enter') goToQuestion(); }
        
        function goToQuestion() {
            const val = document.getElementById('q-search').value.trim(); if(!val) return;
            const numMatch = val.match(/\d+/); if(!numMatch) { showCustomNotification("Ge√ßerli bir sayƒ± girin.", "warning"); return; }
            const target = 'S.' + numMatch[0]; const fIdx = filteredQs.findIndex(q => q['Soru Numarasƒ±'].toUpperCase().endsWith(target));
            if (fIdx !== -1) { idx = fIdx; if(isExamModeActive) showExamQuestion(); else show(); document.getElementById('q-search').value = ''; } else { showCustomNotification("Soru bulunamadƒ±!", "error"); }
        }

        function aciklamaGosterGizle() {
            const a = document.getElementById('aciklama-alani'); const isHidden = a.style.display === "none"; a.style.display = isHidden ? "block" : "none";
            if (isHidden) {
                document.getElementById('q-container').classList.add('ans-mode'); const dogru = (filteredQs[idx]['Doƒüru Cevap'] || "").trim().toLowerCase();
                Array.from(document.getElementById('opts').children).forEach(btn => { if(btn.innerHTML.toLowerCase().includes("<b>" + dogru + ")</b>")) btn.classList.add('correct'); });
            }
        }

        function openModal(id) { document.getElementById(id).style.display = "block"; }
        function closeModal(id) { document.getElementById(id).style.display = "none"; if(id === 'analizModal') closeAnaliz(); }
        window.onclick = function(e) { if (e.target.classList.contains('modal')) { e.target.style.display = "none"; if(e.target.id === 'analizModal') closeAnaliz(); } }

        const analizVerileri = {
            'notlar': `<p>Kendi ≈üahsi notlarƒ±nƒ±z...</p><img src="img/not1.png" style="max-width: 100%; border-radius: 8px; margin-bottom: 15px; display: block; border: 1px solid #ddd;">`
        };
        async function openAnaliz(kategoriId, baslik) {
            document.getElementById('analiz-menu').style.display = 'none'; document.getElementById('analiz-icerik').style.display = 'block'; document.getElementById('analiz-baslik').innerText = baslik;
            const metinAlani = document.getElementById('analiz-metin');
            if (analizVerileri[kategoriId]) { metinAlani.innerHTML = analizVerileri[kategoriId]; return; }
            metinAlani.innerHTML = "<div style='text-align:center; padding: 20px; font-weight:bold;'>Y√ºkleniyor...</div>";
            try {
                const response = await fetch(`html_notlar/${kategoriId}.html`); if (!response.ok) throw new Error("Dosya bulunamadƒ±");
                analizVerileri[kategoriId] = await response.text(); metinAlani.innerHTML = analizVerileri[kategoriId]; 
            } catch (error) { metinAlani.innerHTML = `<div style='color:#dc3545; font-weight:bold; text-align:center;'>HTML not dosyasƒ± bulunamadƒ±.</div>`; }
        }

        function closeAnaliz() {
            document.getElementById('analiz-icerik').style.display = 'none'; 
            document.getElementById('analiz-menu').style.display = 'block';
            document.getElementById('analiz-baslik').innerText = '';
        }

        let guncellemeCache = null;
        async function openGuncelleModal() {
            openModal('guncelleModal'); const metinAlani = document.getElementById('guncelle-metin');
            if (guncellemeCache) { metinAlani.innerHTML = guncellemeCache; return; }
            metinAlani.innerHTML = "<div style='text-align:center; font-weight:bold;'>Y√ºkleniyor...</div>";
            try {
                const response = await fetch('html_notlar/guncelle.html'); if (!response.ok) throw new Error("Dosya bulunamadƒ±");
                guncellemeCache = await response.text(); metinAlani.innerHTML = guncellemeCache; 
            } catch (error) { metinAlani.innerHTML = "<div style='color:#dc3545; font-weight:bold; text-align:center;'>G√ºncelleme notlarƒ±na ula≈üƒ±lamƒ±yor.</div>"; }
        }

        start();
    </script>
</body>
</html>


